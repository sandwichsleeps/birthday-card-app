<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Birthday Card Giggle Machine ðŸŽ‰</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#ff4d8d">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <style>
    :root{
      --accent:#ff4d8d;
      --bg:#fff0f6;
      --ink:#1f2937;
      --border:rgba(0,0,0,.08);
      --radius:16px;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: linear-gradient(135deg,#ffecf7,#e8f7ff);
      color:var(--ink);
    }
    header{
      padding:24px 16px;
      text-align:center;
    }
    h1{ margin:0 0 6px; }
    .subtitle{ color:#6b7280; font-size:14px; }

    .wrap{
      max-width:1100px;
      margin:0 auto;
      padding:16px;
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:16px;
    }
    .panel{
      background:white;
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:16px;
      box-shadow:0 10px 24px rgba(0,0,0,.08);
    }
    label{
      display:block;
      font-size:12px;
      font-weight:700;
      margin-top:10px;
    }
    input{
      width:100%;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--border);
      font-size:14px;
    }
    .row{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
    }
    .actions{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top:14px;
    }
    button{
      border-radius:14px;
      padding:10px 14px;
      border:1px solid var(--border);
      font-weight:800;
      cursor:pointer;
      background:white;
    }
    .primary{
      background:linear-gradient(135deg,var(--accent),#ff7ab0);
      color:white;
      border:none;
    }

    .stack{ display:flex; flex-direction:column; gap:12px; }
    .card{
      border:1px solid var(--border);
      border-radius:16px;
      overflow:hidden;
      display:grid;
      grid-template-columns:1fr 1fr;
    }
    .left{ padding:14px; background:#fff6fa; }
    .right{ padding:14px; }
    .message{ white-space:pre-wrap; font-size:14px; line-height:1.45; }
    .signature{ font-weight:800; margin-top:6px; white-space:nowrap; }

    @media(max-width:900px){
      .wrap{ grid-template-columns:1fr; }
      .card{ grid-template-columns:1fr; }
    }
  </style>
</head>

<body>
<header>
  <h1>Birthday Card Giggle Machine ðŸŽ‰</h1>
  <p class="subtitle">Write a funny birthday message in seconds</p>
</header>

<main class="wrap">
  <!-- Input -->
  <section class="panel">
    <label>To (recipient)</label>
    <input id="name" placeholder="e.g. Ivy">

    <div class="row">
      <div>
        <label>Age</label>
        <input id="age" placeholder="e.g. 9">
      </div>
      <div>
        <label>Hobby</label>
        <input id="hobby" placeholder="e.g. drawing">
      </div>
    </div>

    <div class="row">
      <div>
        <label>Adjective</label>
        <input id="adjective" placeholder="e.g. sparkly">
      </div>
      <div>
        <label>Plural noun</label>
        <input id="plural" placeholder="e.g. confetti">
      </div>
    </div>

    <label>From (your name)</label>
    <input id="sender" placeholder="e.g. Mum, Alex">

    <div class="actions">
      <button class="primary" id="generate">Generate ðŸŽ‰</button>
      <button id="installBtn" style="display:none;">Install App ðŸ“²</button>
    </div>
  </section>

  <!-- Cards -->
  <section class="panel">
    <div class="stack" id="stack"></div>
  </section>
</main>

<script>
  /* PWA registration */
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("./service-worker.js");
  }

  const $ = id => document.getElementById(id);
  const stack = $("stack");

  /* Generate card */
  function generate(){
    const name = $("name").value || "Friend";
    const age = $("age").value || "";
    const hobby = $("hobby").value || "having fun";
    const adj = $("adjective").value || "amazing";
    const plural = $("plural").value || "good times";
    const sender = $("sender").value || "You";

    const msg =
`Hey ${name}!

Happy ${age ? age + "th " : ""}birthday ðŸŽ‰
You are so ${adj}, and your ${hobby} skills are awesome.
May your day be filled with ${plural}!

Cheers,
`;

    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <div class="left"><strong>TO:</strong> ${name}</div>
      <div class="right">
        <div class="message">${msg}</div>
        <div class="signature">â€” ${sender}</div>
      </div>
    `;
    stack.prepend(card);
  }
  $("generate").addEventListener("click", generate);

  /* Install App button logic */
  let deferredPrompt = null;
  const installBtn = $("installBtn");

  const isIOS = () => /iphone|ipad|ipod/i.test(navigator.userAgent);
  const isInstalled = () =>
    window.matchMedia("(display-mode: standalone)").matches ||
    window.navigator.standalone === true;

  function updateInstallButton(){
    if (isInstalled()) {
      installBtn.style.display = "none";
    } else if (deferredPrompt || isIOS()) {
      installBtn.style.display = "inline-block";
    }
  }

  window.addEventListener("beforeinstallprompt", e => {
    e.preventDefault();
    deferredPrompt = e;
    updateInstallButton();
  });

  window.addEventListener("appinstalled", () => {
    deferredPrompt = null;
    updateInstallButton();
  });

  installBtn.addEventListener("click", async () => {
    if (isIOS()) {
      alert("On iPhone/iPad: tap Share â†’ Add to Home Screen.");
      return;
    }
    if (!deferredPrompt) {
      alert("Install not available yet. Try refreshing in Chrome.");
      return;
    }
    deferredPrompt.prompt();
    await deferredPrompt.userChoice;
    deferredPrompt = null;
    updateInstallButton();
  });

  updateInstallButton();
</script>
</body>
</html>
